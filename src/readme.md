# 遮光计算程序说明
## 菜单功能
### 1.文件选择
#### 选择球幕文件与选择摄像机文件
选择格式正确的.mesh文件与.light文件  
若选择了错误格式的文件，会导致遮光计算结果不正确甚至程序崩溃  
单击***计算***按钮便可通过计算得出最后的遮光主体。
### 2.显示设置
对应球幕网格、遮光计算主体的显示方式。通过Checkbox可以选择***显示/不显示***，以及是否以***线框模式显示***   
对于遮光主体，可以选择是否***启用光照渲染***，若启用光照渲染则会以平行光投射到主体上，否则以纯色显示。对于主体可以自定义其显示颜色。  
***启用光源跟随视角***，启用该选项，可以让光源跟随镜头移动，并且可以设置***光源相对角度X/Y***用来改变光源的相对摄像机的位置，调整该选项以获得更好的显示效果。  
***环境光系数***可以改变环境光对物体光照的影响程度，越大的环境光系数，表现为明暗对比越小，光照越明亮。  
***漫反射系数***越大，明暗对比差距越大，建议漫反射系数设为1-环境光系数
### 3.附加网格
附加网格仅用于显示，不参与计算。选择附加网格.mesh文件，文件格式要求与球幕网格文件相同。可以通过附加网格与遮光主体之间的渲染结果来判断其覆盖关系。  
此处仍具有对应该附加网格的***显示网格***与***线框模式***功能
### 4.计算设置
***设置计算点云的边长***： 设置在计算中生成的立方体网格的边长，单位米（m），立方体网格的边长约大，则生成结果所覆盖的区域体积就越大。当球幕网格较大时，应选用对应球幕宽度的边长值。该值初始为5.5。  
***设定计算点云密度***： 计算中生成的立方体网格的密度，对应立方体边长所包含的点的数量。若其值表示为s，则最后计算生成的立方体网格则包含s*s*s个点。边长/密度便是每个点之间的间隔距离。  
***保存计算结果(matchPoints.txt)***: 是否将计算得到的遮光主体的点位置数据输出到当前目录下的文件matchPoints.txt  
***重置计算***： 以上述两个设定的值为基础，进行重新计算。注意，计算点云的密度约大，计算所需耗费的时间越长。
### 5.剔除设置
该设置是为了更加精确地剔除遮光主体，将不需要的主体部分进行手动剔除。  
该设置提供了球形剔除以及平面剔除。拖动对应的滑动条可以进行实时预览式的剔除，此时遮光计算主体并没有真正剔除。拖动滑动条至理想剔除画面时，可单击***应用剔除设置进行计算***按钮应用此剔除。应用此剔除会重新进行计算遮光主体。

## 注意事项
### 1.优化显示帧率
请为该程序选择高性能显卡进行计算。对于NVIDIA平台，请打开NVIDIA控制面板，进入**3D设置**-**管理3D设置**，在程序设置标签页下为该程序指定高性能NVIDIA处理器。
### 2.程序限制
该程序的计算过程涉及到将纹理数组传入到GPU中，由于OpenGL设置同时传输纹理数量的上限为32。因此请勿使用超过32个摄像机的.light文件，可能会导致计算结果出错或程序崩溃。其解决方案正在研究中......
### 3.Imgui滑动条的范围值设定
在项目文件目录下的Recent.json中，可以设定所有包含滑动条的取值范围。